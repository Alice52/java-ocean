## dist

1. 现在微服务和分布式应该全面向 k8s 的基架靠近: 这个是趋势
2. 尽量关注每个方向的`标准` + 典型实现

## 系统的拆分: AKF

- 本质是隔离变化 + 高内聚低耦合 + 业务为中心[自治]{可以 CICD 的单元} + [容错隔离自动化等]

1. x 轴: 水平(横向)扩展
2. y 轴: 将一个微服务拆成多个
3. z 轴: 数据分片[分区]{比如地域上}

## 微服务(架构风格)

1. 关键特征

   - 高度可维护和可测试性
   - 与其他服务松散耦合
   - 且可独立快速部署(持续交付)
   - 能够由一个小团队开发

2. 微服务前提

   - 易于访问网关: 认证、授权
   - 快速配置计算资源
   - 基本监控
   - 快速部署
   - 易于配置存储
   - 标准化的 RPC

## 系统性能优化

1. 压测: 大体上查看每个请求的时间与性能 qps/95
2. 针对性能不达标的 api 进行分析
3. 查看 prod 的 cpu, 内存, 网速
4. 查看数据库监控: 有没有慢 sql
5. 查看这个 api 的具体代码: 分析慢的可能原因
6. 优化相关代码
7. 打 log 去测试环境观察
8. 如果优化不了, 就需要考虑是不是数据库设计的不合理或者业务本身就有问题[改表+冗余]
9. 使用 countdownlacth 去并发 sql/方法测试
