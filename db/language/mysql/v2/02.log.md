## MySQL - LOG

1. [mysql-server]bin-log: 数据备份相关, 需要自己开启, 并指定模式[语句, **row**, mixed]
2. [mysql-server]slow-log: 慢查询日志, 需要自己开启
3. [mysql-server]log-error: 错误信息相关
4. [innodb]undo-log: idb 文件

   - 逻辑日志: 记录的是每一条数据的修改, 不是针对数据页[针对的是行记录] 物理日志是修改加载进内存的最小的逻辑单元`页`, 如果记录的是页的修改则是物理日志
   - 实现事务的原子性
   - 用于实现 mvcc:
   - 在任何操作之前, 首先将数据备份到一个地方[undo-log], 然后对事物进行修改, 如果出错或 rollback 则利用 undo-log 中的备份将数据恢复到事务开始之前的状态: `可以近似按以下方法理解`
     1. delete 时则向 undo-log 中插入 insert 一条数据
     2. insert 则在 undo-log 中记录一条 delete 语句
     3. update 则在 undo-log 中记录一条反向的 update 语句

5. [innodb]redo-log[顺序写]: 预写日志{将来会出现的数据}, commit 前不需要 disk + redo-log 之后的 bin-log 二阶段提交 + `innodb_flush_log_at_trx_commit` + `sync_binlog`

   - 在事务提交之前不需要将数据持久化到磁盘, 只需要记录到 Redolog 中就行[redo-log 和 bin-log 写完之后就会 commit]
   - 当系统崩溃时, 虽然数据没有持久化到磁盘, 但是 redo-log 已经持久话了, 系统可以根据 redo-log 里的内容将数据恢复到最新的状态
   - innodb_flush_log_at_trx_commit:
     1. 默认值是 1: 表示每此都将数据直接写到 os buffer 并调用 fsync 刷入磁盘
     2. 0: 表示写入 innodb 的 logbuffer, 每秒调用一次 fsync 刷入磁盘
     3. 3: 表示直接写入 OS buffer, 每秒调用 fsync 刷入磁盘
   - redo-log 只能循环写, 不能满了就创建新的

6. relay-log: slave
