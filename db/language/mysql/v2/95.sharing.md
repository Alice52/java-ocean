## 分库分表: TiDB

1. 简介

   - 垂直分库: 将应用分为若干模块, 比如订单模块、用户模块、商品模块、支付模块等等{微服务理念}
   - 垂直分表: 一般将不常用字段跟数据较大的字段做拆分{大表拆成多个小表}
   - 水平: 根据场景选择分表字段 + 分散原有数据到更多的库表中{mycat/sharding-jdbc}

2. 分类

   - 如果磁盘或网络有 IO 瓶颈, 那就要分库和垂直分表
   - 如果是 CPU 瓶颈, 即查询效率偏低, **水平分表**

3. 带来的问题

   - 唯一 ID: DB 自增, Snowflake, 号段{guid/leaf-uid}
   - 非 partition key 查询: 映射法{映射表用到覆盖索引}
   - 扩容: 分片(hash 一致性算法及优化) + 数据迁移
   - 事务一致性
   - 跨库 join

---

## TiDB： H**TA**P

1. 开源分布式数据库

   - 结合了 RDBMS 和 NoSQL 的最佳特性
   - 支持无限的**水平**扩展, 具备**强一致**性和**高可用**性
   - 目标是为 OLTP(Online Transactional Processing) 和 OLAP (Online Analytical Processing)

2. 使用场景

   - 原业务的 MySQL 的业务遇到单机容量或者性能瓶颈时: 可以考虑使用 TiDB **无缝**替换 MySQL
   - 大数据量下(kw+级别), 数据增长很快, 接近单机处理的极限, **不想分库分表**或者使用数据库中间件等对业务侵入性较大、对业务有约束的 Sharding 方案
   - 大数据量下, 有**高并发**实时写入、实时查询、**实时统计分析**的需求
   - 有**分布式事务**、多数据中心的数据 100% **强一致性**、**auto-failover 的高可用**的需求
